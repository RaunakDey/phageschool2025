
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../python_exercises_day1/">
      
      
      
      <link rel="icon" href="../../favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>MATLAB - Exercises - Phage School 2025</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/arithmatex.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#matlab-exercises" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Phage School 2025" class="md-header__button md-logo" aria-label="Phage School 2025" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Phage School 2025
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              MATLAB - Exercises
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Phage School 2025" class="md-nav__button md-logo" aria-label="Phage School 2025" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Phage School 2025
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Eco-Evo Principles Day 1
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Eco-Evo Principles Day 1
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python_exercises_day1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python - Exercises
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    MATLAB - Exercises
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    MATLAB - Exercises
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sv-lytic-model" class="md-nav__link">
    <span class="md-ellipsis">
      SV lytic model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SV lytic model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#simulate-a-viral-invasion-" class="md-nav__link">
    <span class="md-ellipsis">
      Simulate a viral invasion -
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sv-simulation" class="md-nav__link">
    <span class="md-ellipsis">
      SV simulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finding-out-basic-reproduction-number" class="md-nav__link">
    <span class="md-ellipsis">
      Finding out basic reproduction number
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#estimating-growth-rate-of-virus-population" class="md-nav__link">
    <span class="md-ellipsis">
      Estimating growth rate of virus population
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-space-plots" class="md-nav__link">
    <span class="md-ellipsis">
      Phase space plots
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#siv-model" class="md-nav__link">
    <span class="md-ellipsis">
      SIV model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SIV model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-reproduction-number" class="md-nav__link">
    <span class="md-ellipsis">
      Basic reproduction number
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modulating-the-viral-burst-size" class="md-nav__link">
    <span class="md-ellipsis">
      Modulating the viral burst size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decrease-of-lysis-rate" class="md-nav__link">
    <span class="md-ellipsis">
      Decrease of lysis rate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-space-dynamics" class="md-nav__link">
    <span class="md-ellipsis">
      Phase space dynamics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sv-lytic-model" class="md-nav__link">
    <span class="md-ellipsis">
      SV lytic model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SV lytic model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#simulate-a-viral-invasion-" class="md-nav__link">
    <span class="md-ellipsis">
      Simulate a viral invasion -
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sv-simulation" class="md-nav__link">
    <span class="md-ellipsis">
      SV simulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finding-out-basic-reproduction-number" class="md-nav__link">
    <span class="md-ellipsis">
      Finding out basic reproduction number
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#estimating-growth-rate-of-virus-population" class="md-nav__link">
    <span class="md-ellipsis">
      Estimating growth rate of virus population
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-space-plots" class="md-nav__link">
    <span class="md-ellipsis">
      Phase space plots
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#siv-model" class="md-nav__link">
    <span class="md-ellipsis">
      SIV model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SIV model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-reproduction-number" class="md-nav__link">
    <span class="md-ellipsis">
      Basic reproduction number
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modulating-the-viral-burst-size" class="md-nav__link">
    <span class="md-ellipsis">
      Modulating the viral burst size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decrease-of-lysis-rate" class="md-nav__link">
    <span class="md-ellipsis">
      Decrease of lysis rate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-space-dynamics" class="md-nav__link">
    <span class="md-ellipsis">
      Phase space dynamics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="matlab-exercises">Matlab - Exercises<a class="headerlink" href="#matlab-exercises" title="Permanent link">&para;</a></h1>
<h2 id="sv-lytic-model">SV lytic model<a class="headerlink" href="#sv-lytic-model" title="Permanent link">&para;</a></h2>
<h3 id="simulate-a-viral-invasion-">Simulate a viral invasion -<a class="headerlink" href="#simulate-a-viral-invasion-" title="Permanent link">&para;</a></h3>
<p>Consider the SV model for lytic infections with susceptible cells (S) and free viruses (V) given by,
\begin{align}
\dot{S} &amp;= bS (1- S/K) - \phi SV - dS 
\end{align}
\begin{align}
\dot{V} &amp;= \beta\phi SV - \phi SV - mV
\end{align}</p>
<p>use the following set of parameter values:</p>
<p>$$ \phi = 6.7 \times 10^{-10} \ \mathrm{mL} \ \mathrm{h}^{-1} $$
 $$  m = 1/24 h^{−1} $$
  $$ d = 1/4 h^{−1}$$
 $$ b = 0.95 h^{−1}$$
$$ K = 7.5\times 10^7 \text{cell mL}^{−1}$$
 $$ \beta = 50$$ virus/cell </p>
<h3 id="sv-simulation">SV simulation<a class="headerlink" href="#sv-simulation" title="Permanent link">&para;</a></h3>
<p>Starting with the SV model, initiate an ‘inoculation’, adding $S0 = 10^4 $cell/mL of microbe, and
then letting the population reach its equilibrium after approximately 24 h.</p>
<p>Question: What population density does it reach? Is it what you expect? Compare your numerical simulation of S at the end of the simulation with the value of the equilibrium that you found analytically. Numerically, create a function describing the SV model and integrate it using python.</p>
<p>Solution:
This is the SV ODE</p>
<div class="codehilite"><pre><span></span><code><span class="k">function</span><span class="w"> </span>dydt<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">SV_ode</span><span class="p">(</span>t, y, pars<span class="p">)</span>
<span class="w">    </span><span class="c">% Standard SV model ODEs</span>
<span class="w">    </span><span class="n">S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="n">V</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="w">    </span><span class="n">phi</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">phi</span><span class="p">;</span>
<span class="w">    </span><span class="n">m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">m</span><span class="p">;</span>
<span class="w">    </span><span class="n">d</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">d</span><span class="p">;</span>
<span class="w">    </span><span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">b</span><span class="p">;</span>
<span class="w">    </span><span class="n">K</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">K</span><span class="p">;</span>
<span class="w">    </span><span class="nb">beta</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">beta</span><span class="p">;</span>

<span class="w">    </span><span class="n">dS</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">b</span><span class="o">*</span><span class="n">S</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">S</span><span class="o">/</span><span class="n">K</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">phi</span><span class="o">*</span><span class="n">S</span><span class="o">*</span><span class="n">V</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">d</span><span class="o">*</span><span class="n">S</span><span class="p">;</span>
<span class="w">    </span><span class="n">dV</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">beta</span><span class="o">*</span><span class="n">phi</span><span class="o">*</span><span class="n">S</span><span class="o">*</span><span class="n">V</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">phi</span><span class="o">*</span><span class="n">S</span><span class="o">*</span><span class="n">V</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">m</span><span class="o">*</span><span class="n">V</span><span class="p">;</span>

<span class="w">    </span><span class="n">dydt</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="n">dS</span><span class="p">;</span><span class="w"> </span><span class="n">dV</span><span class="p">];</span>
<span class="k">end</span>
</code></pre></div>

<p>simulate it with</p>
<div class="codehilite"><pre><span></span><code><span class="c">% Time settings</span>
<span class="n">t0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">      </span><span class="c">% Initial time (hours)</span>
<span class="n">tf</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">24</span><span class="p">;</span><span class="w">     </span><span class="c">% Final time (hours)</span>
<span class="n">T</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span><span class="w"> </span><span class="n">tf</span><span class="p">,</span><span class="w"> </span><span class="mi">250</span><span class="p">);</span><span class="w">  </span><span class="c">% Time vector</span>

<span class="c">% Initial conditions</span>
<span class="n">y0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1e4</span><span class="p">;</span><span class="w"> </span><span class="mi">0</span><span class="p">];</span><span class="w">  </span><span class="c">% [S0; V0] (V0 is 0 by default)</span>

<span class="c">% Parameters</span>
<span class="n">pars</span><span class="p">.</span><span class="n">phi</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">6.7e-10</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">d</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.95</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">K</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">7.5e7</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">beta</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">50</span><span class="p">;</span>

<span class="c">% Solve ODE</span>
<span class="p">[</span><span class="n">T_out</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">ode45</span><span class="p">(@(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="n">SV_ode</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">pars</span><span class="p">),</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">y0</span><span class="p">);</span>

<span class="c">% Extract S and compute equilibrium value</span>
<span class="n">S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Y</span><span class="p">(:,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">Seq_num</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">S</span><span class="p">(</span><span class="k">end</span><span class="p">);</span>

<span class="c">% Plotting</span>
<span class="nb">figure</span><span class="p">;</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">T_out</span><span class="p">,</span><span class="w"> </span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;k&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="n">hold</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
<span class="nb">scatter</span><span class="p">(</span><span class="n">T_out</span><span class="p">(</span><span class="k">end</span><span class="p">),</span><span class="w"> </span><span class="n">Seq_num</span><span class="p">,</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;red&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;filled&#39;</span><span class="p">);</span>
<span class="nb">legend</span><span class="p">(</span><span class="s">&#39;S(t)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;S^* numerically&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Location&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;best&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Box&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;on&#39;</span><span class="p">);</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Time (h)&#39;</span><span class="p">);</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;S cells/mL&#39;</span><span class="p">);</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;SV numerical integration&#39;</span><span class="p">);</span>
<span class="nb">set</span><span class="p">(</span><span class="nb">gca</span><span class="p">,</span><span class="s">&#39;FontSize&#39;</span><span class="p">,</span><span class="mi">20</span><span class="p">);</span>
<span class="n">grid</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>

<span class="c">% Save figure</span>
<span class="nb">saveas</span><span class="p">(</span><span class="nb">gcf</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;SV_model_plot.png&#39;</span><span class="p">);</span>
</code></pre></div>

<p>to get the saved figure
<img alt="Exponential growth" src="../matlab_scripts/SV_model_plot.png" /></p>
<p>Analytically, we find that in the absence of virus in the system <span class="arithmatex">\((V0 = 0), \dot{V} = 0\)</span> and the system remains disease-free. The SV system reduces to the logistic model with cell death, 
<span class="arithmatex">\(\dot{S} = bS(1- S/K) - dS\)</span> Solving <span class="arithmatex">\(\dot{S} = 0\)</span> we find that S approaches the equilibrium point <span class="arithmatex">\(S^∗ = K(1-d/b)\)</span></p>
<div class="codehilite"><pre><span></span><code><span class="c">% Plotting</span>
<span class="nb">figure</span><span class="p">;</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">T_out</span><span class="p">,</span><span class="w"> </span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;k&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="n">hold</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
<span class="nb">scatter</span><span class="p">(</span><span class="n">T_out</span><span class="p">(</span><span class="k">end</span><span class="p">),</span><span class="w"> </span><span class="n">Seq_num</span><span class="p">,</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;red&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;filled&#39;</span><span class="p">);</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">T_out</span><span class="p">,</span><span class="w"> </span><span class="n">Seq_ana</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">T_out</span><span class="p">)),</span><span class="w"> </span><span class="s">&#39;g--&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="nb">legend</span><span class="p">(</span><span class="s">&#39;S(t)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;S^* numerically&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;S^* analytically&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Location&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;best&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Box&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;on&#39;</span><span class="p">);</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Time (h)&#39;</span><span class="p">);</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;S cells/mL&#39;</span><span class="p">);</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;SV numerical integration with equilibrium&#39;</span><span class="p">);</span>
<span class="nb">set</span><span class="p">(</span><span class="nb">gca</span><span class="p">,</span><span class="s">&#39;FontSize&#39;</span><span class="p">,</span><span class="mi">20</span><span class="p">);</span>
<span class="n">grid</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>

<span class="c">% Save figure</span>
<span class="nb">saveas</span><span class="p">(</span><span class="nb">gcf</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;SV_model_equilibrium_plot.png&#39;</span><span class="p">);</span>
</code></pre></div>

<p>to get the saved figure
<img alt="Equilibrium" src="../matlab_scripts/SV_model_equilibrium_plot.png" /></p>
<h3 id="finding-out-basic-reproduction-number">Finding out basic reproduction number<a class="headerlink" href="#finding-out-basic-reproduction-number" title="Permanent link">&para;</a></h3>
<p>Beginning from the disease-free equilibrium, add <span class="arithmatex">\(V_0\)</span> = 100 virus/mL and using β = 50 virus/cell for the burst size, estimate the basic reproduction number <span class="arithmatex">\(R_0\)</span>.</p>
<p><strong>Question:</strong> What is the value of <span class="arithmatex">\(R_0\)</span> and what can you tell about the viral invasion? Simulate the dynamical system, do the viruses increase in abundance?</p>
<p><strong>Answer:</strong> The reproduction number is the number of newly infected induced by one infected in a
fully susceptible population. It is a threshold value, that indicates if the virus is going to invade or
being washed-out. When <span class="arithmatex">\(R_0 &gt; 1\)</span> the virus has a positive growth rate and invade the population,
when <span class="arithmatex">\(R_0 &lt;= 1\)</span> the virus has negative or null population growth rate and is not able to invade.
We want to find a condition for invasion, you can solve <span class="arithmatex">\(\dot{V} &gt; 0 (\text{ at } S∗)\)</span> (disease free equilibrium) for
a initial inoculation of virus V0:</p>
<div class="arithmatex">\[\begin{align}
 \dot{V} &amp;= \beta\phi S^* V_0 - \phi S^* V_0 -mV_0
\end{align}\]</div>
<div class="arithmatex">\[\begin{align}
  \beta\phi S^* &gt; \phi S^* +m
\end{align}\]</div>
<p>The basic reproduction number of the system is <span class="arithmatex">\(R_0 &gt; \frac{\beta\phi S^* }{\beta\phi S^* +m}\)</span> </p>
<div class="codehilite"><pre><span></span><code><span class="c">% Analytical equilibrium</span>
<span class="n">Seq_ana</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">K</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">d</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">b</span><span class="p">);</span>

<span class="c">% Compute R0</span>
<span class="n">R0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">pars</span><span class="p">.</span><span class="n">beta</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">phi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Seq_ana</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">pars</span><span class="p">.</span><span class="n">phi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Seq_ana</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">m</span><span class="p">);</span>
<span class="nb">fprintf</span><span class="p">(</span><span class="s">&#39;R0 = %.4f\n&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">R0</span><span class="p">);</span>
</code></pre></div>

<p>R0 = 23.5258</p>
<div class="codehilite"><pre><span></span><code><span class="c">% Updated initial conditions (start from DFE + virus)</span>
<span class="n">y0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="n">Seq_ana</span><span class="p">;</span><span class="w"> </span><span class="mi">100</span><span class="p">];</span>

<span class="c">% Solve ODE</span>
<span class="p">[</span><span class="n">T_out</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">ode45</span><span class="p">(@(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="n">SV_ode</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">pars</span><span class="p">),</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">y0</span><span class="p">);</span>

<span class="c">% Extract solutions</span>
<span class="n">S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Y</span><span class="p">(:,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">V</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Y</span><span class="p">(:,</span><span class="mi">2</span><span class="p">);</span>

<span class="c">% Plot semilog</span>
<span class="nb">figure</span><span class="p">;</span>
<span class="nb">semilogy</span><span class="p">(</span><span class="n">T_out</span><span class="p">,</span><span class="w"> </span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;k&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="n">hold</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
<span class="nb">semilogy</span><span class="p">(</span><span class="n">T_out</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;r&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="nb">scatter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Seq_ana</span><span class="p">,</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;red&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;filled&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;DisplayName&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;DFE&#39;</span><span class="p">);</span>
<span class="nb">legend</span><span class="p">(</span><span class="s">&#39;S(t)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;V(t)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;DFE&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Location&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;best&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Box&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;on&#39;</span><span class="p">);</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Time (h)&#39;</span><span class="p">);</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Density (cells or viruses/mL)&#39;</span><span class="p">);</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;SV numerical integration from DFE&#39;</span><span class="p">);</span>
<span class="n">grid</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>

<span class="c">% Save figure</span>
<span class="nb">saveas</span><span class="p">(</span><span class="nb">gcf</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;SV_model_DFE_plot.png&#39;</span><span class="p">);</span>
</code></pre></div>

<p>saved figure
<img alt="SV_model_DFE_plot" src="../matlab_scripts/SV_model_DFE_plot.png" /></p>
<h3 id="estimating-growth-rate-of-virus-population">Estimating growth rate of virus population<a class="headerlink" href="#estimating-growth-rate-of-virus-population" title="Permanent link">&para;</a></h3>
<p>Estimate the growth rate of the virus population.
<strong>Question:</strong> Does it agree with your theoretical expectations?
<strong>Answer:</strong> Evaluate $$ \dot{V}|_{S= S^∗}$$. </p>
<div class="arithmatex">\[\begin{align}
1/V dV/dt = \beta\phi S^* - \phi S^* -m 
\end{align}\]</div>
<div class="arithmatex">\[\begin{align}
 r = \beta\phi S^* - \phi S^* -m
\end{align}\]</div>
<p>$ S^{* } $ by is expression and re-arranging:
$ r = (\beta-1)\phi K (1-d/b) -m  $</p>
<p>Numerically estimate the slope of log(V ) over time during the exponential growth phase and compare with the above equation for r with parameter values substituted.</p>
<div class="codehilite"><pre><span></span><code><span class="c">% Take log of virus counts</span>
<span class="n">logV</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">log</span><span class="p">(</span><span class="n">V</span><span class="p">);</span>

<span class="c">% Select exponential growth phase (e.g., T(2:15))</span>
<span class="n">idx</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span><span class="mi">15</span><span class="p">;</span><span class="w">  </span><span class="c">% MATLAB is 1-indexed</span>
<span class="n">x_reg</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">T_out</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span><span class="o">&#39;</span><span class="p">;</span>
<span class="n">y_reg</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">logV</span><span class="p">(</span><span class="n">idx</span><span class="p">);</span>

<span class="c">% Fit linear regression model</span>
<span class="n">coeffs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">polyfit</span><span class="p">(</span><span class="n">x_reg</span><span class="p">,</span><span class="w"> </span><span class="n">y_reg</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="n">r_num</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">coeffs</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w">  </span><span class="c">% Slope of the line (exponential rate)</span>
<span class="n">y_fit</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">polyval</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span><span class="w"> </span><span class="n">x_reg</span><span class="p">);</span>

<span class="c">% Calculate R^2</span>
<span class="n">SS_res</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">((</span><span class="n">y_reg</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y_fit</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span><span class="p">);</span>
<span class="n">SS_tot</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">((</span><span class="n">y_reg</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">mean</span><span class="p">(</span><span class="n">y_reg</span><span class="p">))</span><span class="o">.^</span><span class="mi">2</span><span class="p">);</span>
<span class="n">r_sq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SS_res</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">SS_tot</span><span class="p">;</span>

<span class="c">% Display numerical results</span>
<span class="nb">fprintf</span><span class="p">(</span><span class="s">&#39;Numerical estimate:\n&#39;</span><span class="p">);</span>
<span class="nb">fprintf</span><span class="p">(</span><span class="s">&#39;r_num = %.5f\n&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">r_num</span><span class="p">);</span>
<span class="nb">fprintf</span><span class="p">(</span><span class="s">&#39;R^2 = %.4f\n&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">r_sq</span><span class="p">);</span>

<span class="c">% Plot log(V)</span>
<span class="nb">figure</span><span class="p">;</span>
<span class="nb">scatter</span><span class="p">(</span><span class="n">T_out</span><span class="p">,</span><span class="w"> </span><span class="n">logV</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;filled&#39;</span><span class="p">);</span><span class="w"> </span><span class="n">hold</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
<span class="nb">scatter</span><span class="p">(</span><span class="n">x_reg</span><span class="p">,</span><span class="w"> </span><span class="n">y_reg</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;r&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;filled&#39;</span><span class="p">);</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">x_reg</span><span class="p">,</span><span class="w"> </span><span class="n">y_fit</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;b-&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Time (h)&#39;</span><span class="p">);</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;log(V)&#39;</span><span class="p">);</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Log(V) and exponential phase linear fit&#39;</span><span class="p">);</span>
<span class="nb">legend</span><span class="p">(</span><span class="s">&#39;log(V)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Exponential phase&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Linear fit&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Location&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;best&#39;</span><span class="p">);</span>
<span class="n">grid</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
<span class="nb">set</span><span class="p">(</span><span class="nb">gca</span><span class="p">,</span><span class="s">&#39;FontSize&#39;</span><span class="p">,</span><span class="mi">24</span><span class="p">);</span>
<span class="nb">saveas</span><span class="p">(</span><span class="nb">gcf</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;growth_estimate.png&#39;</span><span class="p">);</span>
</code></pre></div>

<p>saved figure
<img alt="growth_estimate" src="../matlab_scripts/growth_estimate.png" /></p>
<p>Finally, plot the dynamics in the phase plane and evaluate whether the system converges to a new
coexistence equilibrium - in doing so compare the equilibrium to theory, noting how the bacterial
density changes and to what extent the dynamics exhibit cycles or not.</p>
<h3 id="phase-space-plots">Phase space plots<a class="headerlink" href="#phase-space-plots" title="Permanent link">&para;</a></h3>
<p><strong>Question:</strong> Finally, plot the dynamics in the phase plane and evaluate whether the system converges to a new
coexistence equilibrium - in doing so compare the equilibrium to theory, noting how the bacterial
density changes and to what extent the dynamics exhibit cycles or not.</p>
<p><strong>Answer:</strong> Range over the phi to see how the solution trajectories change in the phase. For sufficient small ϕ, no invasion will occur. For large enough ϕ, invasion occurs, and you
can find closed cycles by running out long enough. For intermediate values of ϕ, invasion occurs
but population now tend towards and an equilibrium point.</p>
<p>The endemic equilibrium is 
$$
S^* = m/(\beta -1)\phi
$$</p>
<div class="arithmatex">\[
V^* = \frac{1}{\phi} (d-b-\frac{bm}{(\beta -1)\phi K})
 \]</div>
<div class="codehilite"><pre><span></span><code><span class="c">% Time parameters</span>
<span class="n">t0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">tf</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">5000</span><span class="p">;</span>
<span class="n">dt</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span>
<span class="n">T</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">t0</span><span class="p">:</span><span class="n">dt</span><span class="p">:</span><span class="n">tf</span><span class="p">;</span>

<span class="c">% Shared parameters</span>
<span class="n">pars</span><span class="p">.</span><span class="n">m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">d</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.95</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">K</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">7.5e7</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">beta</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">50</span><span class="p">;</span>

<span class="c">% Different phi values</span>
<span class="n">phi_values</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1e-12</span><span class="p">,</span><span class="w"> </span><span class="mf">1e-9</span><span class="p">,</span><span class="w"> </span><span class="mf">1e-5</span><span class="p">];</span>
<span class="n">titles</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;Low \phi&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Medium \phi&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;High \phi&#39;</span><span class="p">};</span>

<span class="nb">figure</span><span class="p">;</span>

<span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span>
<span class="n">phi</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">phi_values</span><span class="p">(</span><span class="nb">i</span><span class="p">);</span>
<span class="n">pars</span><span class="p">.</span><span class="n">phi</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">phi</span><span class="p">;</span>

<span class="c">% Initial condition &amp; equilibrium calculations</span>
<span class="k">if</span><span class="w"> </span><span class="n">phi</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">1e-12</span>
<span class="w">    </span><span class="n">y0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1000</span><span class="p">;</span><span class="w"> </span><span class="mi">100</span><span class="p">];</span>
<span class="w">    </span><span class="n">Seq_ana</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">K</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">d</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">b</span><span class="p">);</span>
<span class="w">    </span><span class="n">dy</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">ode45</span><span class="p">(@(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="n">SV_ode</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">pars</span><span class="p">),</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">y0</span><span class="p">);</span>
<span class="w">    </span><span class="n">Y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">deval</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">);</span>
<span class="w">    </span><span class="n">S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Y</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">:);</span>
<span class="w">    </span><span class="n">V</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Y</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="p">:);</span>
<span class="k">else</span>
<span class="w">    </span><span class="n">Seq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">m</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">((</span><span class="n">pars</span><span class="p">.</span><span class="n">beta</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">phi</span><span class="p">);</span>
<span class="w">    </span><span class="n">Veq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">phi</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">pars</span><span class="p">.</span><span class="n">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Seq</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">K</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">d</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">phi</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">1e-5</span>
<span class="w">        </span><span class="n">y0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="n">Seq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">250</span><span class="p">;</span><span class="w"> </span><span class="n">Veq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">500</span><span class="p">];</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="n">y0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1000</span><span class="p">;</span><span class="w"> </span><span class="mi">100</span><span class="p">];</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">dy</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">ode45</span><span class="p">(@(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="n">SV_ode</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">pars</span><span class="p">),</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">y0</span><span class="p">);</span>
<span class="w">    </span><span class="n">Y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">deval</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">);</span>
<span class="w">    </span><span class="n">S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Y</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">:);</span>
<span class="w">    </span><span class="n">V</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Y</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="p">:);</span>
<span class="k">end</span>

<span class="c">% Plot in subplot</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="nb">i</span><span class="p">)</span>
<span class="nb">loglog</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="n">hold</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
<span class="nb">scatter</span><span class="p">(</span><span class="n">y0</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">y0</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;r&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;filled&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;DisplayName&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Initial condition&#39;</span><span class="p">);</span>
<span class="nb">scatter</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="k">end</span><span class="p">),</span><span class="w"> </span><span class="n">V</span><span class="p">(</span><span class="k">end</span><span class="p">),</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;g&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;filled&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;DisplayName&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Final condition&#39;</span><span class="p">);</span>

<span class="k">if</span><span class="w"> </span><span class="n">phi</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">1e-12</span>
<span class="w">    </span><span class="nb">scatter</span><span class="p">(</span><span class="n">Seq_ana</span><span class="p">,</span><span class="w"> </span><span class="mf">1e-20</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;filled&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;DisplayName&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;DFE&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="nb">xline</span><span class="p">(</span><span class="n">Seq_ana</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;k--&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;DisplayName&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;S* (DFE)&#39;</span><span class="p">);</span>
<span class="k">else</span>
<span class="w">    </span><span class="nb">scatter</span><span class="p">(</span><span class="n">Seq</span><span class="p">,</span><span class="w"> </span><span class="n">Veq</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;k&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;filled&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;DisplayName&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Endemic Eq.&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="nb">xline</span><span class="p">(</span><span class="n">Seq</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;k--&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;DisplayName&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;S*&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="nb">yline</span><span class="p">(</span><span class="n">Veq</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;k--&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;DisplayName&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;V*&#39;</span><span class="p">);</span>
<span class="k">end</span>

<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Microbe S&#39;</span><span class="p">);</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Virus V&#39;</span><span class="p">);</span>
<span class="nb">title</span><span class="p">(</span><span class="n">titles</span><span class="p">{</span><span class="nb">i</span><span class="p">});</span>
<span class="nb">legend</span><span class="p">(</span><span class="s">&#39;Location&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;best&#39;</span><span class="p">);</span>
<span class="n">grid</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
<span class="k">end</span>

<span class="nb">sgtitle</span><span class="p">(</span><span class="s">&#39;Phase Plane (log-log) for Different \phi Values&#39;</span><span class="p">);</span>
<span class="k">end</span>
</code></pre></div>

<p>saved figure
<img alt="gsv_phase_plot" src="../matlab_scripts/sv_phase_plot.png" /></p>
<h2 id="siv-model">SIV model<a class="headerlink" href="#siv-model" title="Permanent link">&para;</a></h2>
<p>Consider the SIV model with susceptible S cells, infected I cells and free virus particles V ,</p>
<div class="arithmatex">\[\begin{align}
\dot{S} &amp;= bS (1- \frac{S+I}{K}) - \phi SV - dS\\
\dot{I} &amp;= \phi SV - \eta I - dI\\
\dot{V} &amp;= \beta\phi SV - \phi SV - mV
\end{align}\]</div>
<p>Use the following set of parameter values:</p>
<div class="arithmatex">\[ \phi = 6.7 \times 10^{-10} \ \mathrm{mL} \ \mathrm{h}^{-1} \]</div>
<p>$$  m = 1/24 h^{−1} $$</p>
<p>$$ d = 1/4 h^{−1}$$</p>
<p>$$ b = 0.95 h^{−1}$$</p>
<p>$$ \eta = 1 h^{−1}$$</p>
<div class="arithmatex">\[ K = 5\times 10^7 \text{cell mL}^{−1}\]</div>
<h3 id="basic-reproduction-number">Basic reproduction number<a class="headerlink" href="#basic-reproduction-number" title="Permanent link">&para;</a></h3>
<p>Beginning from the disease-free equilibrium, add V0 = 100 virus/mL with a burst β = 50 virus/cell
and a lysis rate η = 0.5 hours. Estimate the basic reproduction number R0.</p>
<p><strong>Question:</strong> Is R0 &gt; 1? Simulate the dynamical system and conclude on the invasion of the virus.</p>
<p><strong>Answer</strong> For zero initial viral density. 
$$ \dot{S} = 0$$</p>
<div class="arithmatex">\[ S^* = K(1-\frac{d}{b}) \]</div>
<p>R0 = viral production * probability to infect before virus die * probability to lyse before cells
die.
S0, $$ R_0 = \beta  \frac{mS^<em> }{mS^</em> +m } \frac{\eta}{\eta+d}$$</p>
<div class="codehilite"><pre><span></span><code>#<span class="n">Estimate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">R0</span>
#<span class="w"> </span><span class="n">parameters</span>
<span class="n">pars</span><span class="p">={}</span>
<span class="n">pars</span><span class="p">[</span><span class="s">&quot;phi&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">6.7E-10</span>
<span class="n">pars</span><span class="p">[</span><span class="s">&quot;m&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span>
<span class="n">pars</span><span class="p">[</span><span class="s">&quot;d&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span>
<span class="n">pars</span><span class="p">[</span><span class="s">&quot;b&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.95</span>
<span class="n">pars</span><span class="p">[</span><span class="s">&quot;K&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">5E6</span>
<span class="n">pars</span><span class="p">[</span><span class="s">&quot;beta&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">50</span>
<span class="n">pars</span><span class="p">[</span><span class="s">&quot;eta&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.5</span>
#<span class="w"> </span><span class="n">DFE</span>
<span class="n">S_DFE</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pars</span><span class="p">[</span><span class="s">&quot;K&quot;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">pars</span><span class="p">[</span><span class="s">&quot;d&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">pars</span><span class="p">[</span><span class="s">&quot;b&quot;</span><span class="p">])</span>
<span class="nb">prod</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pars</span><span class="p">[</span><span class="s">&quot;beta&quot;</span><span class="p">]</span>
<span class="n">proba_lyse</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pars</span><span class="p">[</span><span class="s">&quot;phi&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">S_DFE</span><span class="o">/</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s">&quot;phi&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">S_DFE</span><span class="o">+</span><span class="n">pars</span><span class="p">[</span><span class="s">&quot;m&quot;</span><span class="p">])</span>
<span class="n">proba_inf</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pars</span><span class="p">[</span><span class="s">&quot;eta&quot;</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s">&quot;eta&quot;</span><span class="p">]</span><span class="o">+</span><span class="n">pars</span><span class="p">[</span><span class="s">&quot;d&quot;</span><span class="p">])</span>


<span class="n">R0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">prod</span><span class="o">*</span><span class="n">proba_lyse</span><span class="o">*</span><span class="n">proba_inf</span>
<span class="nb">print</span><span class="p">(</span><span class="n">R0</span><span class="p">)</span>
</code></pre></div>

<p>R0 = 1.8643</p>
<div class="codehilite"><pre><span></span><code><span class="c">% Time</span>
<span class="n">t0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">tf</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2000</span><span class="p">;</span>
<span class="n">T</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span><span class="w"> </span><span class="n">tf</span><span class="p">,</span><span class="w"> </span><span class="mi">500</span><span class="p">);</span><span class="w">  </span><span class="c">% same as Python&#39;s linspace</span>

<span class="c">% Parameters</span>
<span class="n">pars</span><span class="p">.</span><span class="n">phi</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">6.7e-10</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">d</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.95</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">K</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">5e6</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">beta</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">50</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">eta</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span>

<span class="c">% Disease-Free Equilibrium</span>
<span class="n">S_DFE</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">K</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">d</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">b</span><span class="p">);</span>

<span class="c">% Initial Conditions [S, I, V]</span>
<span class="n">y0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="n">S_DFE</span><span class="p">;</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="mi">100</span><span class="p">];</span>

<span class="c">% Solve the system</span>
<span class="p">[</span><span class="n">T_out</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">ode45</span><span class="p">(@(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="n">SIV_ode</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">pars</span><span class="p">),</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">y0</span><span class="p">);</span>
<span class="n">S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Y</span><span class="p">(:,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="n">I</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Y</span><span class="p">(:,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="n">V</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Y</span><span class="p">(:,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>

<span class="c">% Plotting</span>
<span class="nb">figure</span><span class="p">;</span>
<span class="nb">semilogy</span><span class="p">(</span><span class="n">T_out</span><span class="p">,</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">I</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;k&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="n">hold</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
<span class="nb">semilogy</span><span class="p">(</span><span class="n">T_out</span><span class="p">,</span><span class="w"> </span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;g&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="nb">semilogy</span><span class="p">(</span><span class="n">T_out</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;r&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="nb">scatter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">S_DFE</span><span class="p">,</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;filled&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;MarkerEdgeColor&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;k&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;MarkerFaceColor&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;red&#39;</span><span class="p">);</span>

<span class="nb">legend</span><span class="p">(</span><span class="s">&#39;S + I&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;S&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;V&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;DFE&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Location&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;best&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Box&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;on&#39;</span><span class="p">);</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Time (h)&#39;</span><span class="p">);</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Density (cells or viruses/mL)&#39;</span><span class="p">);</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;SIV model dynamics from DFE&#39;</span><span class="p">);</span>
<span class="n">grid</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
</code></pre></div>

<p>saved figure
<img alt="siv_integration" src="../matlab_scripts/siv_dynamics.png" /></p>
<h3 id="modulating-the-viral-burst-size">Modulating the viral burst size<a class="headerlink" href="#modulating-the-viral-burst-size" title="Permanent link">&para;</a></h3>
<p><strong>Question:</strong> Do the viruses always invade? Why or why not? If there is a critical point in the
dynamics? Does it agree with your theoretical expectations?</p>
<p><strong>Answer:</strong> No, when the burst size is too low, then R0 &lt; 1 and the invasion is not possible. Calculate
the critical burst size using the equation of R0 &gt; 1.</p>
<div class="codehilite"><pre><span></span><code><span class="c">% Time</span>
<span class="n">t0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">tf</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2000</span><span class="p">;</span>
<span class="n">T</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span><span class="w"> </span><span class="n">tf</span><span class="p">,</span><span class="w"> </span><span class="mi">500</span><span class="p">);</span>

<span class="c">% Parameters (same as before, but beta changed)</span>
<span class="n">pars</span><span class="p">.</span><span class="n">phi</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">6.7e-10</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">d</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.95</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">K</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">5e6</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">beta</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="c">% changed here</span>
<span class="n">pars</span><span class="p">.</span><span class="n">eta</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span>

<span class="c">% Disease-Free Equilibrium</span>
<span class="n">S_DFE</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">K</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">d</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">b</span><span class="p">);</span>

<span class="c">% Initial Conditions [S, I, V]</span>
<span class="n">y0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="n">S_DFE</span><span class="p">;</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="mi">100</span><span class="p">];</span>

<span class="c">% Integrate system</span>
<span class="p">[</span><span class="n">T_out</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">ode45</span><span class="p">(@(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="n">SIV_ode</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">pars</span><span class="p">),</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">y0</span><span class="p">);</span>
<span class="n">S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Y</span><span class="p">(:,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="n">I</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Y</span><span class="p">(:,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="n">V</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Y</span><span class="p">(:,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>

<span class="c">% Plotting</span>
<span class="nb">figure</span><span class="p">;</span>
<span class="nb">semilogy</span><span class="p">(</span><span class="n">T_out</span><span class="p">,</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">I</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;k&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="n">hold</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
<span class="nb">semilogy</span><span class="p">(</span><span class="n">T_out</span><span class="p">,</span><span class="w"> </span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;g&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="nb">semilogy</span><span class="p">(</span><span class="n">T_out</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;r&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="nb">scatter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">S_DFE</span><span class="p">,</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;filled&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;MarkerEdgeColor&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;k&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;MarkerFaceColor&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;red&#39;</span><span class="p">);</span>

<span class="nb">legend</span><span class="p">(</span><span class="s">&#39;S + I&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;S&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;V&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;DFE&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Location&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;best&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Box&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;on&#39;</span><span class="p">);</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Time (h)&#39;</span><span class="p">);</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Density (cells or viruses/mL)&#39;</span><span class="p">);</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;SIV Model Dynamics (\beta = 10)&#39;</span><span class="p">);</span>
<span class="nb">set</span><span class="p">(</span><span class="nb">gca</span><span class="p">,</span><span class="s">&#39;FontSize&#39;</span><span class="p">,</span><span class="mi">24</span><span class="p">);</span>
<span class="n">grid</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
<span class="nb">saveas</span><span class="p">(</span><span class="nb">gcf</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;siv_beta_10.png&#39;</span><span class="p">);</span>
</code></pre></div>

<p>saved figure
<img alt="siv_beta_10" src="../matlab_scripts/siv_beta_10.png" /></p>
<p>So the invasion criterion, i.e., where the basic reproduction number R0 is greater than 0 is
$$
\beta_{critical} &gt; \frac{(\eta+d)(\phi S^<em> +m)}{\eta\phi S^</em> }
$$</p>
<div class="codehilite"><pre><span></span><code><span class="c">% Parameters</span>
<span class="n">pars</span><span class="p">.</span><span class="n">phi</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">6.7e-10</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">d</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.95</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">K</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">5e6</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">eta</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span>

<span class="c">% Disease-Free Equilibrium</span>
<span class="n">S_DFE</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">K</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">d</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">b</span><span class="p">);</span>

<span class="c">% Critical burst size beta_crit = numerator / denominator</span>
<span class="n">num</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">pars</span><span class="p">.</span><span class="n">eta</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">d</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">pars</span><span class="p">.</span><span class="n">phi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">S_DFE</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">m</span><span class="p">);</span>
<span class="n">den</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">eta</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">phi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">S_DFE</span><span class="p">;</span>
<span class="n">beta_crit</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">den</span><span class="p">;</span>

<span class="c">% Sweep over burst sizes</span>
<span class="n">Brange</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">);</span>
<span class="n">R0_vals</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">Brange</span><span class="p">));</span>

<span class="nb">figure</span><span class="p">;</span><span class="w"> </span><span class="n">hold</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>

<span class="c">% Loop over burst sizes</span>
<span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">Brange</span><span class="p">)</span>
<span class="w">    </span><span class="nb">beta</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Brange</span><span class="p">(</span><span class="nb">i</span><span class="p">);</span>
<span class="w">    </span><span class="n">pars</span><span class="p">.</span><span class="n">beta</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">beta</span><span class="p">;</span>

<span class="w">    </span><span class="c">% Components of R0</span>
<span class="w">    </span><span class="nb">prod</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">beta</span><span class="p">;</span>
<span class="w">    </span><span class="n">proba_lyse</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">pars</span><span class="p">.</span><span class="n">phi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">S_DFE</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">pars</span><span class="p">.</span><span class="n">phi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">S_DFE</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">m</span><span class="p">);</span>
<span class="w">    </span><span class="n">proba_inf</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">eta</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">pars</span><span class="p">.</span><span class="n">eta</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">d</span><span class="p">);</span>
<span class="w">    </span><span class="n">R0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">prod</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">proba_lyse</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">proba_inf</span><span class="p">;</span>

<span class="w">    </span><span class="c">% Store and plot</span>
<span class="w">    </span><span class="n">R0_vals</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">R0</span><span class="p">;</span>
<span class="w">    </span><span class="n">c</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.75</span><span class="p">,</span><span class="w"> </span><span class="mf">0.75</span><span class="p">,</span><span class="w"> </span><span class="mf">0.75</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">length</span><span class="p">(</span><span class="n">Brange</span><span class="p">);</span>
<span class="w">    </span><span class="nb">scatter</span><span class="p">(</span><span class="nb">beta</span><span class="p">,</span><span class="w"> </span><span class="n">R0</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;filled&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;MarkerFaceColor&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">);</span>
<span class="k">end</span>

<span class="c">% Highlight beta_crit</span>
<span class="nb">scatter</span><span class="p">(</span><span class="n">beta_crit</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;r&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;filled&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;DisplayName&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;\beta_{crit}&#39;</span><span class="p">);</span>
<span class="nb">yline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;k--&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;DisplayName&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;R_0 = 1&#39;</span><span class="p">);</span>

<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Burst Size (\beta)&#39;</span><span class="p">);</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;R_0&#39;</span><span class="p">);</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Invasion Threshold for Varying Burst Size&#39;</span><span class="p">);</span>
<span class="nb">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">105</span><span class="p">]);</span>
<span class="nb">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="n">R0_vals</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.5</span><span class="p">]);</span>
<span class="nb">legend</span><span class="p">(</span><span class="s">&#39;Location&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;southeast&#39;</span><span class="p">);</span>
<span class="n">grid</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
<span class="nb">saveas</span><span class="p">(</span><span class="nb">gcf</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;siv_beta_variation.png&#39;</span><span class="p">);</span>
</code></pre></div>

<p>saved figure
<img alt="siv_beta_variation" src="../matlab_scripts/siv_beta_variation.png" /></p>
<h3 id="decrease-of-lysis-rate">Decrease of lysis rate<a class="headerlink" href="#decrease-of-lysis-rate" title="Permanent link">&para;</a></h3>
<p>Returning to burst size of 50, consider what happens if the viral lysis rate η decreases from 1 to 0.1 h.
<strong>Question:</strong> Do the viruses always invade? Why or why not? If there is a critical point in the
dynamics? Does it agree with your theoretical expectations?
<strong>Answer:</strong> Similarly than the burst size, when the lysis rate is too low, then R0 &lt; 1 and the invasion
is not possible.</p>
<div class="codehilite"><pre><span></span><code><span class="c">% Time setup</span>
<span class="n">t0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">tf</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2000</span><span class="p">;</span>
<span class="n">T</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span><span class="w"> </span><span class="n">tf</span><span class="p">,</span><span class="w"> </span><span class="mi">500</span><span class="p">);</span>

<span class="c">% Parameters</span>
<span class="n">pars</span><span class="p">.</span><span class="n">phi</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">6.7e-10</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">d</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.95</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">K</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">5e6</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">beta</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">50</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">eta</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w"> </span><span class="c">% Updated eta</span>

<span class="c">% Disease-Free Equilibrium</span>
<span class="n">S_DFE</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">K</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">d</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">b</span><span class="p">);</span>

<span class="c">% Initial Conditions: [S, I, V]</span>
<span class="n">y0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="n">S_DFE</span><span class="p">;</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="mi">100</span><span class="p">];</span>

<span class="c">% Integrate the ODE</span>
<span class="p">[</span><span class="n">T_out</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">ode45</span><span class="p">(@(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="n">SIV_ode</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">pars</span><span class="p">),</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">y0</span><span class="p">);</span>
<span class="n">S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Y</span><span class="p">(:,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">I</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Y</span><span class="p">(:,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">V</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Y</span><span class="p">(:,</span><span class="mi">3</span><span class="p">);</span>

<span class="c">% Plotting</span>
<span class="nb">figure</span><span class="p">;</span>
<span class="nb">semilogy</span><span class="p">(</span><span class="n">T_out</span><span class="p">,</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">I</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;k&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="n">hold</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
<span class="nb">semilogy</span><span class="p">(</span><span class="n">T_out</span><span class="p">,</span><span class="w"> </span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;g&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="nb">semilogy</span><span class="p">(</span><span class="n">T_out</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;r&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="nb">scatter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">S_DFE</span><span class="p">,</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;filled&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;MarkerEdgeColor&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;k&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;MarkerFaceColor&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;red&#39;</span><span class="p">);</span>

<span class="nb">legend</span><span class="p">(</span><span class="s">&#39;S + I&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;S&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;V&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;DFE&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Location&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;best&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Box&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;on&#39;</span><span class="p">);</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Time (h)&#39;</span><span class="p">);</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Density (cells or viruses/mL)&#39;</span><span class="p">);</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;SIV Model Dynamics (\eta = 0.1 h^{-1})&#39;</span><span class="p">);</span>
<span class="n">grid</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
<span class="nb">saveas</span><span class="p">(</span><span class="nb">gcf</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;siv_eta_0pt1.png&#39;</span><span class="p">);</span>
</code></pre></div>

<p>Estimate the threshold value of η by considering, basic reproduction number greater than 1 as,
$
\eta_{crit} = \frac{d(\phi S^<em> +m)}{\beta\phi S^</em> -\phi S^* -m}
$</p>
<div class="codehilite"><pre><span></span><code><span class="c">% Parameters</span>
<span class="n">pars</span><span class="p">.</span><span class="n">phi</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">6.7e-10</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">d</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.95</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">K</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">5e6</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">beta</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">50</span><span class="p">;</span>

<span class="c">% Disease-Free Equilibrium</span>
<span class="n">S_DFE</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">K</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">d</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">b</span><span class="p">);</span>

<span class="c">% Numerator and Denominator</span>
<span class="n">num</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">d</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">pars</span><span class="p">.</span><span class="n">phi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">S_DFE</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">m</span><span class="p">);</span>
<span class="n">den</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">beta</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">phi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">S_DFE</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">phi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">S_DFE</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">m</span><span class="p">;</span>

<span class="c">% Critical lysis rate</span>
<span class="n">eta_crit</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">den</span><span class="p">;</span>

<span class="c">% Display</span>
<span class="nb">fprintf</span><span class="p">(</span><span class="s">&#39;Critical lysis rate (eta_crit) = %.4f h^{-1}\n&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">eta_crit</span><span class="p">);</span>
</code></pre></div>

<p>Critical lysis rate (eta_crit) = 0.1392 h^{-1}</p>
<p>saved figure
<img alt="siv_eta_0pt1" src="../matlab_scripts/siv_eta_0pt1.png" /></p>
<h3 id="phase-space-dynamics">Phase space dynamics<a class="headerlink" href="#phase-space-dynamics" title="Permanent link">&para;</a></h3>
<p>Finally, plot the dynamics in the S-V phase plane and evaluate whether the system converges to
a new coexistence equilibrium - in doing so, compare the equilibrium to theory, noting how the
bacterial density changes, and to what extent the dynamics exhibit cycles or not.</p>
<div class="codehilite"><pre><span></span><code><span class="c">% Time setup</span>
<span class="n">t0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">tf</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">5000</span><span class="p">;</span>
<span class="n">dt</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span>
<span class="n">T</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">t0</span><span class="p">:</span><span class="n">dt</span><span class="p">:</span><span class="n">tf</span><span class="p">;</span>

<span class="c">% Fixed parameters</span>
<span class="n">pars</span><span class="p">.</span><span class="n">m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">d</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.95</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">K</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">5e6</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">beta</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">50</span><span class="p">;</span>
<span class="n">pars</span><span class="p">.</span><span class="n">eta</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span>

<span class="c">% DFE for plotting reference</span>
<span class="n">S_DFE</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">K</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">d</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">pars</span><span class="p">.</span><span class="n">b</span><span class="p">);</span>

<span class="c">% List of phi values and corresponding initial conditions</span>
<span class="n">phi_list</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1e-12</span><span class="p">,</span><span class="w"> </span><span class="mf">1e-9</span><span class="p">,</span><span class="w"> </span><span class="mf">5e-9</span><span class="p">,</span><span class="w"> </span><span class="mf">1e-8</span><span class="p">];</span>
<span class="n">y0_list</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{[</span><span class="mi">1000</span><span class="p">;</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="mi">100</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1000</span><span class="p">;</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="mi">100</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">100</span><span class="p">;</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="mf">1e6</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">100</span><span class="p">;</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="mf">1e6</span><span class="p">]};</span>
<span class="n">titles</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;Low \phi&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Medium \phi&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Medium \phi (high V_0)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;High \phi&#39;</span><span class="p">};</span>

<span class="c">% Create subplot figure</span>
<span class="nb">figure</span><span class="p">;</span>
<span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span>
<span class="w">    </span><span class="n">pars</span><span class="p">.</span><span class="n">phi</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">phi_list</span><span class="p">(</span><span class="nb">i</span><span class="p">);</span>
<span class="w">    </span><span class="n">y0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">y0_list</span><span class="p">{</span><span class="nb">i</span><span class="p">};</span>

<span class="w">    </span><span class="c">% Integrate SIV model</span>
<span class="w">    </span><span class="p">[</span><span class="o">~</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">ode45</span><span class="p">(@(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="n">SIV_ode</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">pars</span><span class="p">),</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">y0</span><span class="p">);</span>
<span class="w">    </span><span class="n">S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Y</span><span class="p">(:,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="n">V</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Y</span><span class="p">(:,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>

<span class="w">    </span><span class="c">% Plot in subplot</span>
<span class="w">    </span><span class="nb">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="nb">i</span><span class="p">);</span>
<span class="w">    </span><span class="nb">loglog</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="n">hold</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
<span class="w">    </span><span class="nb">scatter</span><span class="p">(</span><span class="n">y0</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">y0</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;red&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;filled&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;DisplayName&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Initial&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="nb">scatter</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="k">end</span><span class="p">),</span><span class="w"> </span><span class="n">V</span><span class="p">(</span><span class="k">end</span><span class="p">),</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;green&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;filled&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;DisplayName&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Final&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="nb">scatter</span><span class="p">(</span><span class="n">S_DFE</span><span class="p">,</span><span class="w"> </span><span class="mf">1e-20</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;blue&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;filled&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;DisplayName&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;DFE&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Microbe S&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Virus V&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="nb">title</span><span class="p">(</span><span class="n">titles</span><span class="p">{</span><span class="nb">i</span><span class="p">});</span>
<span class="w">    </span><span class="nb">legend</span><span class="p">(</span><span class="s">&#39;Location&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;best&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="n">grid</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
<span class="k">end</span>

<span class="nb">sgtitle</span><span class="p">(</span><span class="s">&#39;SIV Model: Phase Plane for Different \phi&#39;</span><span class="p">);</span>
<span class="nb">saveas</span><span class="p">(</span><span class="nb">gcf</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;siv_phi_variation.png&#39;</span><span class="p">);</span>
</code></pre></div>

<p>saved figure
<img alt="siv_phi_variation" src="../matlab_scripts/siv_phi_variation.png" /></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>